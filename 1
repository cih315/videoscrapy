# Define your item pipelines here
#
# Don't forget to add your pipeline to the ITEM_PIPELINES setting
# See: http://doc.scrapy.org/topics/item-pipeline.html

from video.models import Movie,MicroMovie 

class VideoscrapyPipeline(object):
    def process_item(self, item, spider):
        return item

class MoviePipeline(object):

    #def __init__(self):
        #MicroMovie.objects.all().delete()
   
    def process_item(self, item, spider):
        print('the spider name is===>'+spider.name)
        print('the spider domains is===>'+spider.allowed_domains[0])
        if spider.name == 'micromovie':
            #movie = Movie(name=name,url=item['url'], pic =item['pic'],description=item['description'])
            movie = MicroMovie(name=item['name'],url=item['url'], pic =item['pic'],count=item['count'],desc='',cate=item['cate'])
            movie.save()

        return item 
